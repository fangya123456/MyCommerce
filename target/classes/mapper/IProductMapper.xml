<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fy.commerce.mapper.IProductMapper">

    <resultMap id="ProductResultMap" type="com.fy.commerce.model.Product">
        <id column="pid" property="pid" jdbcType="INTEGER"/>
        <result column="pname" property="pname" jdbcType="VARCHAR"/>
        <result column="market_price" property="marketPrice" jdbcType="DOUBLE"/>
        <result column="shop_price" property="shopPrice" jdbcType="DOUBLE"/>
        <result column="pimage" property="pimage" jdbcType="VARCHAR"/>
        <result column="pnum" property="pnum" jdbcType="INTEGER"/>
        <result column="pinvotory" property="pinvotory" jdbcType="INTEGER"/>
        <result column="pdesc" property="pdesc" jdbcType="VARCHAR"/>
        <result column="is_hot" property="isHot" javaType="INTEGER"/>
        <result column="pdate" property="pdate" jdbcType="TIMESTAMP"/>
        <result column="csid" property="csid" jdbcType="INTEGER"/>
    </resultMap>

    <select id="selectAllProductInfo" resultMap="ProductResultMap">
        select * from product
    </select>
    <select id="selectProductInfoById" parameterType="int" resultMap="ProductResultMap">
        select * from product where pid = #{pid}
    </select>

    <select id="selectProductInfoByExample" parameterType="com.fy.commerce.model.Product" resultMap="ProductResultMap">
        select * from product
        <where>
            <choose>
                <when test="pid !=null">
                    pid = #{pid}
                </when>
                <when test="pname !=null">
                  AND pname = #{pname}
                </when>
                <when test="pimage">
                  AND pimage = #{pimage}
                </when>
            </choose>
        </where>
    </select>

    <select id="selectProductInfoByForeignKey" parameterType="int" resultMap="ProductResultMap" >
        select (pname,market_price,shop_price,pimage,pdesc) from product where csid = #{csid};
    </select>

    <insert id="insertProductInfo" parameterType="com.fy.commerce.model.Product" useGeneratedKeys="true" keyProperty="pid">
        insert into product values (#{pname},#{market_price},#{shop_price},#{pimage},#{pnum},#{pinvotory},#{pdesc},#{is_hot},#{pdate},#{csid})
    </insert>

    <update id="updateProductInfo" parameterType="com.fy.commerce.model.Product">
        update product
        <set>
            <if test="pname != null">
                pname = #{pname},
            </if>
            <if test="market_price != null">
                market_price = #{market_price},
            </if>
            <if test="shop_price != null">
                shop_price = #{shop_price},
            </if>
            <if test="pimage != null">
                pimage = #{pimage},
            </if>
            <if test="pnum != null">
                pnum = #{pnum},
            </if>
            <if test="pinvotory != null">
                pinvotory = #{pinvotory},
            </if>
            <if test="pdesc != null">
                pdesc = #{pdesc},
            </if>
            <if test="pdate != null">
                pdate = #{pdate}
            </if>
        </set>
        <where>
            <choose>
                <when test="pid != null">
                    pid = #{pid}
                </when>
                <when test="pname != null">
                    and pname = #{pname}
                </when>
            </choose>
        </where>
    </update>

    <delete id="deleteProductInfoById" parameterType="int">
        delete from product where pid = #{pid}
    </delete>

    <delete id="deleteProductInfoByExample" parameterType="com.fy.commerce.model.Product">
        delete from product
        <where>
            <choose>
                <when test="pid != null">
                    pid = #{pid}
                </when>
                <when test="pname != null">
                    AND  pname = #{pname}
                </when>
            </choose>
        </where>
    </delete>
</mapper>